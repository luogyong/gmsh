%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% GetDP vs SmallFEM         %%
%% Vectorial OSRC: 4 domains %%
%% K = 4                     %%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

clear all;
close all;

getdp = ...
    [
        8.138754516832e+01
        5.887044090430e+01
        4.791296689531e+01
        2.459963311940e+01
        1.198052677440e+01
        3.776162747599e+00
        1.864533032196e+00
        1.086218516027e+00
        5.598358832066e-01
        3.244193201215e-01
        1.998088755141e-01
        1.228091075496e-01
        8.474216066418e-02
        6.039393306242e-02
        4.541649169403e-02
        3.249108430214e-02
        2.430691031577e-02
        1.803315141705e-02
        1.423693718875e-02
        1.106219910678e-02
        8.884199576072e-03
        7.040964442344e-03
        5.504026460054e-03
        4.275603468693e-03
        3.284967940926e-03
        2.530448900307e-03
        2.001732826595e-03
        1.593068379022e-03
        1.284975021930e-03
        1.016645575366e-03
        8.306818537730e-04
        6.696670306436e-04
        5.551511017766e-04
        4.479230285567e-04
        3.606032024866e-04
        2.771492421065e-04
        2.122592997916e-04
        1.619083389702e-04
        1.308094550174e-04
        1.057901053337e-04
        8.580930154799e-05
        6.587540660542e-05
        5.084771657076e-05
        3.919851208053e-05
        3.112280442618e-05
        2.512334541753e-05
        2.082411235380e-05
        1.694931374126e-05
        1.361459631982e-05
        1.058714379070e-05
        8.242451185180e-06
        6.376401089565e-06
        5.142812490606e-06
        4.089109599020e-06
        3.252417536941e-06
        2.436526712666e-06
        1.804475880384e-06
        1.378278030190e-06
        1.111409801822e-06
        8.953328000533e-07
        7.170404460164e-07
        5.492222117647e-07
        4.120979195145e-07
        3.157764403071e-07
        2.520464832730e-07
        2.013939593344e-07
        1.631450582194e-07
        1.284685436765e-07
        1.010066242603e-07
        7.988300446349e-08
    ];

smallfem = ...
    [
        5.076329222402e+00
        3.638059446588e+00
        2.957553586046e+00
        1.231438296118e+00
        5.722846226827e-01
        1.992946172072e-01
        9.690973234967e-02
        5.792262027232e-02
        2.910517128084e-02
        1.654170630011e-02
        1.034040684939e-02
        6.231715260230e-03
        4.300443596051e-03
        3.050016508422e-03
        2.305540057438e-03
        1.632310692582e-03
        1.224561279754e-03
        9.072641168065e-04
        7.186568389793e-04
        5.566819250012e-04
        4.515207875154e-04
        3.538722024349e-04
        2.794296648900e-04
        2.156237250192e-04
        1.673387596714e-04
        1.284466782911e-04
        1.027949977249e-04
        8.123445610242e-05
        6.577687321221e-05
        5.152541463912e-05
        4.220166268736e-05
        3.394249584219e-05
        2.846836254261e-05
        2.294667207346e-05
        1.868002980536e-05
        1.424028812391e-05
        1.093629280207e-05
        8.282826193938e-06
        6.704605386457e-06
        5.399494128110e-06
        4.424382061100e-06
        3.364820136816e-06
        2.625075651171e-06
        2.022874089668e-06
        1.611792248198e-06
        1.294006286865e-06
        1.075398838600e-06
        8.649014929902e-07
        6.987875722761e-07
        5.428225655695e-07
        4.260520137987e-07
        3.295557843887e-07
        2.665499104431e-07
        2.111511788595e-07
        1.696157105248e-07
        1.253564697681e-07
        9.343296027802e-08
        7.124382203461e-08
        5.724001084126e-08
        4.566823741075e-08
        3.691441245145e-08
        2.793611427037e-08
        2.101302071346e-08
        1.613261375386e-08
        1.302389313270e-08
        1.034273714995e-08
        8.413986277464e-09
        6.532900608151e-09
        5.151004516077e-09
        4.075518011477e-09
    ];

it = [1:size(smallfem, 1)];

semilogy(it, ...
         getdp,             '-o', 'linewidth', 3, ...
         smallfem,          '-o', 'linewidth', 3, ...
         getdp ./ smallfem, '-*', 'linewidth', 3);
legend({'GetDP', 'SmallFEM', 'GetDP / SmallFEM'}, 'location', 'SouthWest');
title('Vectorial OSRC: 4 domains -- K = 4');
xlabel('Iteration');
ylabel('Residual');

print('vosrc4.png');