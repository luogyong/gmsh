%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% GetDP vs SmallFEM         %%
%% Vectorial OSRC: 4 domains %%
%% K = 1                     %%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

clear all;
close all;

getdp = ...
    [
        5.994766225934e+01
        4.339806501384e+01
        3.708111232878e+01
        1.841782265587e+01
        9.632672470057e+00
        4.255005775862e+00
        1.969564282071e+00
        1.070175086200e+00
        2.401071753971e-01
        9.749191600691e-02
        2.679543314966e-02
        1.181620594588e-02
        5.090817276032e-03
        2.414466970173e-03
        9.399719429660e-04
        4.434306986352e-04
        2.110368848895e-04
        1.036625575556e-04
        5.021879334522e-05
        2.457878433675e-05
        1.291197870229e-05
        6.757386005411e-06
        4.334650387181e-06
        2.921725192814e-06
        1.984640163329e-06
        9.548027918188e-07
        6.026112101511e-07
        3.979250820569e-07
        2.617722500088e-07
        1.346648021713e-07
        7.381391693750e-08
        4.057071765007e-08
    ];

smallfem = ...
    [
        3.759855971933e+00
        2.706681225961e+00
        2.315160343209e+00
        9.832379262834e-01
        5.074966037453e-01
        2.365747831035e-01
        9.905781542636e-02
        5.370215315579e-02
        1.179534919118e-02
        4.789120753868e-03
        1.314360255062e-03
        5.772971243182e-04
        2.465828621024e-04
        1.167396646067e-04
        4.583460570540e-05
        2.164310559740e-05
        1.042484012426e-05
        5.137760489897e-06
        2.632473448575e-06
        1.261917768153e-06
        6.847521149959e-07
        3.655544902309e-07
        2.442030164309e-07
        1.622719968487e-07
        1.079616484287e-07
        5.190039821677e-08
        3.398644168523e-08
        2.251915014592e-08
        1.443592648065e-08
        7.185110780417e-09
        3.977540993083e-09
        2.169874311627e-09
    ];

it = [1:size(smallfem, 1)];

semilogy(it, ...
         getdp,             '-o', 'linewidth', 3, ...
         smallfem,          '-o', 'linewidth', 3, ...
         getdp ./ smallfem, '-*', 'linewidth', 3);
legend({'GetDP', 'SmallFEM', 'GetDP / SmallFEM'}, 'location', 'SouthWest');
title('Vectorial OSRC: 4 domains -- K = 1');
xlabel('Iteration');
ylabel('Residual');

print('vosrc1.png');