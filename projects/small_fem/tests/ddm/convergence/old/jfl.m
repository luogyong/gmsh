%%%%%%%%%%%%%%%%%%%%%%%
%% GetDP vs SmallFEM %%
%% JFLee: 4 domains  %%
%%%%%%%%%%%%%%%%%%%%%%%

clear all;
close all;

getdp = ...
    [
        4.432163044408e+01
        3.163388091813e+01
        2.620185427765e+01
        6.824444186601e+00
        3.381749459275e+00
        2.284413063191e+00
        1.556132727389e+00
        1.051617667978e+00
        8.308527243372e-01
        5.703607389757e-01
        4.525511935968e-01
        3.456843164359e-01
        2.870428991161e-01
        2.219181019798e-01
        1.862884669280e-01
        1.487665923573e-01
        1.266030040176e-01
        1.031349779079e-01
        8.884351111170e-02
        7.036615171653e-02
        5.971820870554e-02
        4.846654854459e-02
        4.162325539732e-02
        3.435813502429e-02
        2.992056791517e-02
        2.440725735557e-02
        2.109733938154e-02
        1.739875312014e-02
        1.510858244459e-02
        1.229558785415e-02
        1.062294107540e-02
        8.843358379583e-03
        7.748287850204e-03
        6.452253151926e-03
        5.635546621468e-03
        4.698488465128e-03
        4.117287852949e-03
        3.388288168236e-03
        2.951197786831e-03
        2.459611157679e-03
        2.154969749754e-03
        1.815432523999e-03
        1.597904739337e-03
        1.322067145338e-03
        1.157512130372e-03
        9.725324805726e-04
        8.525498995667e-04
        7.051930546393e-04
        6.160742327080e-04
        5.136118372400e-04
        4.479786849860e-04
        3.759933390833e-04
        3.312743098411e-04
        2.731058158354e-04
        2.372310040984e-04
        1.995617472184e-04
        1.760435225443e-04
        1.442559968349e-04
        1.247731247357e-04
        1.032228292072e-04
        8.973210586680e-05
        7.431589895383e-05
        6.481748383014e-05
        5.409944483063e-05
        4.728153940186e-05
        3.813592714537e-05
        3.276788447998e-05
        2.688310633814e-05
        2.324778595336e-05
        1.899126870277e-05
        1.644132960098e-05
        1.342248774358e-05
        1.155738742621e-05
        9.622178670442e-06
        8.389987788333e-06
        6.634343671248e-06
        5.641153196649e-06
        4.671069024613e-06
        4.071658571947e-06
        3.323503814247e-06
        2.866385169819e-06
        2.340764599171e-06
        2.023600645500e-06
        1.687882961616e-06
        1.472854531930e-06
        1.180723682996e-06
        1.009319083900e-06
        8.427184706813e-07
        7.363771308573e-07
        5.989973551190e-07
        5.160732685778e-07
        4.222991713744e-07
        3.639243522190e-07
        2.933443736352e-07
        2.518274986664e-07
        2.050651104223e-07
        1.763321870893e-07
        1.475753017899e-07
        1.291994451687e-07
        1.027968757580e-07
        8.758891621362e-08
        7.138449203563e-08
        6.164232690756e-08
        5.096289253982e-08
        4.415927913916e-08
    ];

smallfem = ...
    [
        4.609046840761e+00
        3.248976193983e+00
        2.689595797978e+00
        6.550862619468e-01
        3.271067348963e-01
        2.247390637395e-01
        1.530410140290e-01
        1.033280307191e-01
        8.246372167009e-02
        5.631646852858e-02
        4.487770644957e-02
        3.414579139320e-02
        2.851680508548e-02
        2.191653614444e-02
        1.846832119140e-02
        1.478930068145e-02
        1.261957965196e-02
        1.026905963920e-02
        8.870569389159e-03
        7.024050503113e-03
        5.984037426519e-03
        4.849793576782e-03
        4.179417666260e-03
        3.427831406091e-03
        2.984796837781e-03
        2.437993755568e-03
        2.105719135695e-03
        1.729753656212e-03
        1.504202055131e-03
        1.219599675989e-03
        1.054622115043e-03
        8.808321769290e-04
        7.733477847244e-04
        6.423818889232e-04
        5.627027643694e-04
        4.677518879606e-04
        4.099349790178e-04
        3.373607310861e-04
        2.956084310630e-04
        2.459114343030e-04
        2.160131075809e-04
        1.817612568826e-04
        1.600118933748e-04
        1.318209615243e-04
        1.156175412886e-04
        9.728588712329e-05
        8.544654043933e-05
        7.026901590405e-05
        6.149771577167e-05
        5.102899834657e-05
        4.466822322919e-05
        3.738617473550e-05
        3.311969868179e-05
        2.735665742433e-05
        2.386519442760e-05
        1.997609857674e-05
        1.761665333259e-05
        1.441544070223e-05
        1.251345007860e-05
        1.038781700875e-05
        9.034595259804e-06
        7.449698711902e-06
        6.501225113739e-06
        5.393939797628e-06
        4.719715183713e-06
        3.795796999028e-06
        3.273412158169e-06
        2.682997386873e-06
        2.326702973713e-06
        1.894287800455e-06
        1.641712596943e-06
        1.337617647650e-06
        1.155808997760e-06
        9.602010881926e-07
        8.389069823489e-07
        6.623074088276e-07
        5.623586875775e-07
        4.652474423146e-07
        4.068132130252e-07
        3.321069141840e-07
        2.871861753945e-07
        2.333587644434e-07
        2.016783711501e-07
        1.687751780661e-07
        1.473032323855e-07
        1.180619857347e-07
        1.012022023554e-07
        8.435950429551e-08
        7.377615771028e-08
        5.991578229230e-08
        5.173407528811e-08
        4.216262557170e-08
        3.644475048890e-08
        2.919492899490e-08
        2.504786466474e-08
        2.037333006360e-08
        1.755685091089e-08
        1.469869041852e-08
        1.290774142339e-08
        1.029496980745e-08
        8.775021780875e-09
        7.131324905520e-09
        6.172353222440e-09
        5.096770739668e-09
        4.420627023020e-09
    ];

it = [1:size(smallfem, 1)];

semilogy(it, ...
         getdp,             '-o', 'linewidth', 3, ...
         smallfem,          '-o', 'linewidth', 3, ...
         getdp ./ smallfem, '-*', 'linewidth', 3);
legend({'GetDP', 'SmallFEM', 'GetDP / SmallFEM'}, 'location', 'SouthWest');
title('JFLee: 4 domains');
xlabel('Iteration');
ylabel('Residual');

print('jfl.png');