%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% GetDP vs SmallFEM        %%
%% OSRC (Pade 4): 4 domains %%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

clear all;
close all;

getdp = ...
    [
        6.447031364014e+01
        4.520141341232e+01
        3.566736667363e+01
        5.467245501182e+00
        2.826786083286e+00
        1.748642923935e+00
        1.713005079547e-01
        4.056425133352e-02
        1.346713469643e-02
        3.817005584801e-03
        1.121839221886e-03
        4.395167159275e-04
        1.411603222565e-04
        4.980154471824e-05
        1.517629676441e-05
        5.261703338218e-06
        1.417456303481e-06
        5.463548381267e-07
        2.108559776822e-07
        4.307309819530e-08
    ];

smallfem = ...
    [
        4.558739596017e+01
        3.196222594307e+01
        2.522063684199e+01
        3.865926368297e+00
        1.998839608455e+00
        1.236477269389e+00
        1.211277507954e-01
        2.868325719168e-02
        9.522702266996e-03
        2.699030532840e-03
        7.932601211967e-04
        3.107852502773e-04
        9.981542110243e-05
        3.521500998392e-05
        1.073126235579e-05
        3.720586111301e-06
        1.002292964430e-06
        3.863312110225e-07
        1.490976914235e-07
        3.045727970661e-08
    ];

it = [1:size(smallfem, 1)];

semilogy(it, ...
         getdp,              '-o', 'linewidth', 3, ...
         smallfem,           '-o', 'linewidth', 3, ...
         smallfem * sqrt(2), '*',  'linewidth', 3);
legend({'GetDP', 'SmallFEM', 'SmallFEM * \sqrt{2}'});
title('OSRC (Pade 4): 4 domains');
xlabel('Iteration');
ylabel('Residual');

print('osrc.png');